package org.reactome.cli

import io.ktor.client.HttpClient
import io.ktor.client.engine.cio.CIO
import org.assertj.core.api.Assertions.assertThat
import org.junit.jupiter.api.Test

class ReactomeCliTest {

    @Test
    fun `Should return response for one protein`() {
        val cli = ReactomeCli(HttpClient(CIO), "http://reactome.org", "${System.getProperty("user.dir")}/src/test/resources/uniprot.txt")
        assertThat(cli.execute()).isEqualTo(
            "{\"summary\":{\"token\":\"MjAyNTAyMDUyMDIwNDNfMTA1MTY%3D\",\"projection\":true,\"interactors\":false,\"type\":\"OVERREPRESENTATION\",\"sampleName\":\"GBM Uniprot\",\"text\":true,\"includeDisease\":true},\"expression\":{\"columnNames\":[]},\"identifiersNotFound\":0,\"pathwaysFound\":12,\"pathways\":[{\"stId\":\"R-HSA-8963896\",\"dbId\":8963896,\"name\":\"HDL assembly\",\"species\":{\"dbId\":48887,\"taxId\":\"9606\",\"name\":\"Homo sapiens\"},\"llp\":true,\"entities\":{\"resource\":\"TOTAL\",\"total\":18,\"found\":1,\"ratio\":0.0011414077362079899,\"pValue\":0.0011414077362079666,\"fdr\":0.007609384908053407,\"exp\":[]},\"reactions\":{\"resource\":\"TOTAL\",\"total\":9,\"found\":1,\"ratio\":5.897385492431689E-4},\"inDisease\":false},{\"stId\":\"R-HSA-140837\",\"dbId\":140837,\"name\":\"Intrinsic Pathway of Fibrin Clot Formation\",\"species\":{\"dbId\":48887,\"taxId\":\"9606\",\"name\":\"Homo sapiens\"},\"llp\":true,\"entities\":{\"resource\":\"TOTAL\",\"total\":26,\"found\":1,\"ratio\":0.001648700063411541,\"pValue\":0.0016487000634115567,\"fdr\":0.007609384908053407,\"exp\":[]},\"reactions\":{\"resource\":\"TOTAL\",\"total\":24,\"found\":1,\"ratio\":0.001572636131315117},\"inDisease\":false},{\"stId\":\"R-HSA-8963898\",\"dbId\":8963898,\"name\":\"Plasma lipoprotein assembly\",\"species\":{\"dbId\":48887,\"taxId\":\"9606\",\"name\":\"Homo sapiens\"},\"llp\":false,\"entities\":{\"resource\":\"TOTAL\",\"total\":30,\"found\":1,\"ratio\":0.0019023462270133164,\"pValue\":0.0019023462270133518,\"fdr\":0.007609384908053407,\"exp\":[]},\"reactions\":{\"resource\":\"TOTAL\",\"total\":19,\"found\":1,\"ratio\":0.0012450036039578008},\"inDisease\":false},{\"stId\":\"R-HSA-140877\",\"dbId\":140877,\"name\":\"Formation of Fibrin Clot (Clotting Cascade)\",\"species\":{\"dbId\":48887,\"taxId\":\"9606\",\"name\":\"Homo sapiens\"},\"llp\":false,\"entities\":{\"resource\":\"TOTAL\",\"total\":43,\"found\":1,\"ratio\":0.0027266962587190868,\"pValue\":0.00272669625871913,\"fdr\":0.00818008877615739,\"exp\":[]},\"reactions\":{\"resource\":\"TOTAL\",\"total\":61,\"found\":1,\"ratio\":0.003997116833759255},\"inDisease\":false},{\"stId\":\"R-HSA-174824\",\"dbId\":174824,\"name\":\"Plasma lipoprotein assembly, remodeling, and clearance\",\"species\":{\"dbId\":48887,\"taxId\":\"9606\",\"name\":\"Homo sapiens\"},\"llp\":false,\"entities\":{\"resource\":\"TOTAL\",\"total\":102,\"found\":1,\"ratio\":0.006467977171845276,\"pValue\":0.006467977171845329,\"fdr\":0.00938490805326575,\"exp\":[]},\"reactions\":{\"resource\":\"TOTAL\",\"total\":86,\"found\":1,\"ratio\":0.005635279470545836},\"inDisease\":false},{\"stId\":\"R-HSA-114608\",\"dbId\":114608,\"name\":\"Platelet degranulation \",\"species\":{\"dbId\":48887,\"taxId\":\"9606\",\"name\":\"Homo sapiens\"},\"llp\":true,\"entities\":{\"resource\":\"TOTAL\",\"total\":141,\"found\":1,\"ratio\":0.008941027266962586,\"pValue\":0.008941027266962553,\"fdr\":0.00938490805326575,\"exp\":[]},\"reactions\":{\"resource\":\"TOTAL\",\"total\":11,\"found\":1,\"ratio\":7.207915601860952E-4},\"inDisease\":false},{\"stId\":\"R-HSA-76005\",\"dbId\":76005,\"name\":\"Response to elevated platelet cytosolic Ca2+\",\"species\":{\"dbId\":48887,\"taxId\":\"9606\",\"name\":\"Homo sapiens\"},\"llp\":true,\"entities\":{\"resource\":\"TOTAL\",\"total\":148,\"found\":1,\"ratio\":0.009384908053265695,\"pValue\":0.00938490805326575,\"fdr\":0.00938490805326575,\"exp\":[]},\"reactions\":{\"resource\":\"TOTAL\",\"total\":14,\"found\":1,\"ratio\":9.173710766004849E-4},\"inDisease\":false},{\"stId\":\"R-HSA-1474228\",\"dbId\":1474228,\"name\":\"Degradation of the extracellular matrix\",\"species\":{\"dbId\":48887,\"taxId\":\"9606\",\"name\":\"Homo sapiens\"},\"llp\":true,\"entities\":{\"resource\":\"TOTAL\",\"total\":148,\"found\":1,\"ratio\":0.009384908053265695,\"pValue\":0.00938490805326575,\"fdr\":0.00938490805326575,\"exp\":[]},\"reactions\":{\"resource\":\"TOTAL\",\"total\":105,\"found\":1,\"ratio\":0.006880283074503637},\"inDisease\":false},{\"stId\":\"R-HSA-76002\",\"dbId\":76002,\"name\":\"Platelet activation, signaling and aggregation\",\"species\":{\"dbId\":48887,\"taxId\":\"9606\",\"name\":\"Homo sapiens\"},\"llp\":false,\"entities\":{\"resource\":\"TOTAL\",\"total\":293,\"found\":1,\"ratio\":0.018579581483830057,\"pValue\":0.0185795814838301,\"fdr\":0.0185795814838301,\"exp\":[]},\"reactions\":{\"resource\":\"TOTAL\",\"total\":119,\"found\":1,\"ratio\":0.007797654151104122},\"inDisease\":false},{\"stId\":\"R-HSA-1474244\",\"dbId\":1474244,\"name\":\"Extracellular matrix organization\",\"species\":{\"dbId\":48887,\"taxId\":\"9606\",\"name\":\"Homo sapiens\"},\"llp\":true,\"entities\":{\"resource\":\"TOTAL\",\"total\":350,\"found\":1,\"ratio\":0.02219403931515536,\"pValue\":0.0221940393151554,\"fdr\":0.0221940393151554,\"exp\":[]},\"reactions\":{\"resource\":\"TOTAL\",\"total\":330,\"found\":1,\"ratio\":0.021623746805582857},\"inDisease\":false},{\"stId\":\"R-HSA-109582\",\"dbId\":109582,\"name\":\"Hemostasis\",\"species\":{\"dbId\":48887,\"taxId\":\"9606\",\"name\":\"Homo sapiens\"},\"llp\":false,\"entities\":{\"resource\":\"TOTAL\",\"total\":804,\"found\":1,\"ratio\":0.05098287888395688,\"pValue\":0.05098287888395692,\"fdr\":0.05098287888395692,\"exp\":[]},\"reactions\":{\"resource\":\"TOTAL\",\"total\":342,\"found\":2,\"ratio\":0.022410064871240417},\"inDisease\":false},{\"stId\":\"R-HSA-382551\",\"dbId\":382551,\"name\":\"Transport of small molecules\",\"species\":{\"dbId\":48887,\"taxId\":\"9606\",\"name\":\"Homo sapiens\"},\"llp\":false,\"entities\":{\"resource\":\"TOTAL\",\"total\":1002,\"found\":1,\"ratio\":0.06353836398224477,\"pValue\":0.06353836398224477,\"fdr\":0.06353836398224477,\"exp\":[]},\"reactions\":{\"resource\":\"TOTAL\",\"total\":465,\"found\":1,\"ratio\":0.030469825044230393},\"inDisease\":false}],\"resourceSummary\":[{\"resource\":\"TOTAL\",\"pathways\":12,\"filtered\":12},{\"resource\":\"UNIPROT\",\"pathways\":12,\"filtered\":12}],\"speciesSummary\":[{\"dbId\":48887,\"taxId\":\"9606\",\"name\":\"Homo sapiens\",\"pathways\":12,\"filtered\":12}],\"warnings\":[]}"
        )
    }
}